# 如何处理客户端访问nginx反向代理的服务器跳转路径不正确的问题

## 问题描述

有一个spring boot服务端，使用了spring securiy进行权限验证，未登录访问应用的任意路径会跳转到 *`/login`* 页面。\
服务端程序使用nginx代理8081端口至backend三级域名的443端口，并且配置了该二级域名下所有80端口的请求重定向至https的443端口，证书已配置。\
当客户端访问 *`域名/abc`* 时，跳转到了 *`127.0.0.1/login`* 而不是 *主机/login*

## 寻找解决方案思路

### 检查浏览器请求

点开浏览器f12，查看网络标签，发现共请求了两次：

1. 请求 *`域名/abc`* 响应为301，Location响应头中显示重定向到 *`https://域名/abc`*
2. 请求 *`https://域名/abc`* 响应为302，Location响应头中显示重定向到 *`http://127.0.0.1:8081/login`*

问题出现在第2步，第2步的响应中Location不是正确的重定向地址 *`https://域名/login`* 。

### 响应是如何生成的
