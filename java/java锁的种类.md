# java中锁的概念和种类

## 锁是什么

锁是多线程程序中用来控制多线程运行的**对象**，首先它是java对象。任何java对象都可以作为锁。

## 传统使用方式

synchronized关键字是最传统的使用锁的方式。

``` java
synchronized(this){
    // do something...
    ...
}
```

上面的例子里使用的是**this**这个对象作为锁。在很多案例中，也有使用new一个Object对象作为锁的，也有使用Lock接口下的各种实现来作为锁的，它们都是由多线程使用同一个java对象做锁。  

## 阻塞队列和等待队列

每个锁都有一个阻塞队列和等待队列，阻塞（Blocking）和等待（Waiting、Timed_Waiting）也是线程生命周期中的重要状态。  
在写多线程程序的时候，要注意当前的操作会让线程进入哪个队列。  

### 进入阻塞队列的操作

* synchronized关键字
* Lock接口各种实现的lock()方法

### 进入等待队列的操作

* wait()锁对象的方法
* **线程对象**的join()方法，注意不是锁对象
* LockSupport.park()
* Lock接口各种实现类的await()方法

## 悲观锁与乐观锁

## 自旋锁

为了避免线程在内核态与用户态切换的开销而使用的锁，持有此锁会一直轮询等待，不进入等待队列，避免了内核态与用户态切换的开销。如果能在短时间内释放锁，用自旋锁是很好的选择。

## 公平锁与非公平锁