# java查看字节码

使用命令`javap -c XXX.class`

## 例

分析自动拆箱装箱机制的程序

``` java
public class Demo {

	public static void main(String[] args) {
		int a=128;
		int b=128;
		
		int c=3;
		int d=3;
		
		boolean eq1=(a==b);
		boolean eq2=(c==d);
	}
}
```

字节码输出

``` cmd
javap -c Demo.class
```

``` txt 
Compiled from "Demo.java"
public class demo.Demo {
  public demo.Demo();
    Code:
       0: aload_0
       1: invokespecial #8                  // Method java/lang/Object."<init>":()V
       4: return

  public static void main(java.lang.String[]);
    Code:
       0: sipush        128
       3: istore_1
       4: sipush        128
       7: istore_2
       8: iconst_3
       9: istore_3
      10: iconst_3
      11: istore        4
      13: iload_1
      14: iload_2
      15: if_icmpne     22
      18: iconst_1
      19: goto          23
      22: iconst_0
      23: istore        5
      25: iload_3
      26: iload         4
      28: if_icmpne     35
      31: iconst_1
      32: goto          36
      35: iconst_0
      36: istore        6
      38: return
}
```

主要指令的意义可以查 **jvm指令表**

## 显示局部变量表和常量池信息

使用`javap -verbose XXX.class`

### 常量池详解

第一列是每一项的索引地址，字节码指令用这个索引地址来代表对应的常量

``` txt
Constant pool:
   #1 = Class              #2             // com/example/App
   #2 = Utf8               com/example/App
   #3 = Class              #4             // java/lang/Object
   #4 = Utf8               java/lang/Object
   #5 = Utf8               <init>
   #6 = Utf8               ()V
   #7 = Utf8               Code
   #8 = Methodref          #3.#9          // java/lang/Object."<init>":()V
   #9 = NameAndType        #5:#6          // "<init>":()V
  #10 = Utf8               LineNumberTable
  #11 = Utf8               LocalVariableTable
  #12 = Utf8               this
  #13 = Utf8               Lcom/example/App;
  #14 = Utf8               main
  #15 = Utf8               ([Ljava/lang/String;)V
  #16 = String             #17            // test
  #17 = Utf8               test
  #18 = String             #19            // test1
  #19 = Utf8               test1
  #20 = Class              #21            // java/lang/String
  #21 = Utf8               java/lang/String
  #22 = Methodref          #20.#23        // java/lang/String."<init>":(Ljava/lang/String;)V
  #23 = NameAndType        #5:#24         // "<init>":(Ljava/lang/String;)V
  #24 = Utf8               (Ljava/lang/String;)V
  #25 = Utf8               args
  #26 = Utf8               [Ljava/lang/String;
  #27 = Utf8               a1
  #28 = Utf8               Ljava/lang/String;
  #29 = Utf8               a2
  #30 = Utf8               a3
  #31 = Utf8               a4
  #32 = Utf8               SourceFile
  #33 = Utf8               App.java
```

